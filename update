<script>
  const data = [
    // your data remains unchanged
    // ...
  ];

  const container = document.getElementById("expenses-container");
  let grandTotal = 0;

  data.forEach((day, index) => {
    const section = document.createElement("section");

    // Header with date and status toggle
    const h2 = document.createElement("h2");
    h2.textContent = day.date;

    const statusBtn = document.createElement("button");
    statusBtn.textContent = "Mark as Paid";
    statusBtn.className = "status-btn";
    statusBtn.dataset.status = "unpaid";

    const statusDiv = document.createElement("div");
    statusDiv.className = "status";

    // Load saved status from localStorage (if exists)
    const savedStatus = localStorage.getItem(`status-${day.date}`);
    if (savedStatus === "paid" || (index === data.length - 1 && savedStatus === null)) {
      statusBtn.dataset.status = "paid";
      statusBtn.textContent = "Mark as Unpaid";
      statusBtn.classList.add("paid");
      statusDiv.textContent = "Status: Paid";
      statusDiv.classList.add("paid");
      localStorage.setItem(`status-${day.date}`, "paid"); // save default for last day
    } else {
      statusBtn.dataset.status = "unpaid";
      statusBtn.textContent = "Mark as Paid";
      statusBtn.classList.remove("paid");
      statusDiv.textContent = "Status: Unpaid";
      statusDiv.classList.remove("paid");
    }

    statusBtn.addEventListener("click", () => {
      const isPaid = statusBtn.dataset.status === "paid";

      if (isPaid) {
        statusBtn.dataset.status = "unpaid";
        statusBtn.textContent = "Mark as Paid";
        statusBtn.classList.remove("paid");
        statusDiv.textContent = "Status: Unpaid";
        statusDiv.classList.remove("paid");
        localStorage.setItem(`status-${day.date}`, "unpaid");
      } else {
        statusBtn.dataset.status = "paid";
        statusBtn.textContent = "Mark as Unpaid";
        statusBtn.classList.add("paid");
        statusDiv.textContent = "Status: Paid";
        statusDiv.classList.add("paid");
        localStorage.setItem(`status-${day.date}`, "paid");
      }
    });

    h2.appendChild(statusBtn);
    section.appendChild(h2);

    // Expense items
    const ul = document.createElement("ul");
    let dailyTotal = 0;

    day.items.forEach(item => {
      const li = document.createElement("li");
      li.className = "item";

      const descSpan = document.createElement("span");
      descSpan.textContent = item.desc;

      const costSpan = document.createElement("span");
      costSpan.textContent = "৳" + item.cost.toLocaleString();
      costSpan.className = "cost";

      li.appendChild(descSpan);
      li.appendChild(costSpan);
      ul.appendChild(li);

      dailyTotal += item.cost;
    });

    section.appendChild(ul);

    // Daily total
    const totalDiv = document.createElement("div");
    totalDiv.className = "total";
    totalDiv.textContent = "Total for the day: ৳" + dailyTotal.toLocaleString();
    section.appendChild(totalDiv);

    // Receipt upload
    const receiptSection = document.createElement("div");
    receiptSection.className = "receipt-section";

    const receiptLabel = document.createElement("label");
    receiptLabel.textContent = "Upload receipt (1 file only): ";
    receiptLabel.htmlFor = `receipt-${index}`;

    const receiptInput = document.createElement("input");
    receiptInput.type = "file";
    receiptInput.accept = ".pdf,.jpg,.png";
    receiptInput.id = `receipt-${index}`;
    receiptInput.title = "Upload receipt for this day";
    receiptInput.multiple = false;

    const receiptLink = document.createElement("div");
    receiptLink.className = "receipt-link";

    receiptInput.addEventListener("change", () => {
      if (receiptInput.files.length > 0) {
        receiptLink.innerHTML = `<a href="#" target="_blank">Receipt uploaded: ${receiptInput.files[0].name}</a>`;
      } else {
        receiptLink.innerHTML = "";
      }
    });

    receiptSection.appendChild(receiptLabel);
    receiptSection.appendChild(receiptInput);
    receiptSection.appendChild(receiptLink);
    section.appendChild(receiptSection);

    // Append status
    section.appendChild(statusDiv);
    container.appendChild(section);

    grandTotal += dailyTotal;
  });

  const grandTotalDiv = document.getElementById("grand-total");
  grandTotalDiv.textContent = "Grand Total: ৳" + grandTotal.toLocaleString();
</script>
